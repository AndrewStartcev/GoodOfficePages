// ======== Скрипты ==========================
document.addEventListener("DOMContentLoaded", function() {
  const burgerOpen = document.querySelector(".header__burger");
  const burgerClose = document.querySelector(".header__close");
  const mobileMenu = document.querySelector(".header__menu");
  const mobileMenuContent = document.querySelector(".header__content");

  burgerOpen.addEventListener('click', function() {
    mobileMenu.classList.add("active");
  }, false);
  burgerClose.addEventListener('click', function() {
    mobileMenu.classList.remove("active");
  }, false);

  document.addEventListener('click', function(e) {
    const target = e.target;
    const its_menu = target == mobileMenuContent || mobileMenuContent.contains(target);
    const its_btnMenu = target == burgerOpen;
    const menu_is_active = mobileMenu.classList.contains('active');

    if (!its_menu && !its_btnMenu && menu_is_active) {
      mobileMenu.classList.remove("active");
    }
  });

  const homeSwiper = new Swiper('.home-slider', {
    loop: true,
    // Navigation arrows
    navigation: {
      nextEl: '.home-slider__next',
      prevEl: '.home-slider__prev',
    },
    autoplay: {
      delay: 3500,
    },
  });

  const aboutTyped = new Typed('.about-typed', {
    stringsElement: "#typed-strings",
    typeSpeed: 100,
    backSpeed: 100,
    loop: true,
  });

  const anchors = [].slice.call(document.querySelectorAll('a[href*="#"]'));
  const animationTime = 300;
  const framesCount = 20;

  anchors.forEach(function(item) {
    item.addEventListener('click', function(e) {
      e.preventDefault();

      let coordY = document.querySelector(item.getAttribute('href')).getBoundingClientRect().top + window.pageYOffset;

      let scroller = setInterval(function() {
        let scrollBy = coordY / framesCount;

        if(scrollBy > window.pageYOffset - coordY && window.innerHeight + window.pageYOffset < document.body.offsetHeight) {
          window.scrollBy(0, scrollBy);
        } else {
          window.scrollTo(0, coordY);
          clearInterval(scroller);
        }
      }, animationTime / framesCount);
    });
  });

  const btnScrollUp = document.querySelector(".btn-up-scroll");

  window.addEventListener('scroll', function () {
    if (window.scrollY > 420) {
      btnScrollUp.classList.add("active");
    } else {
      btnScrollUp.classList.remove("active");
    }
  });


});
// ======== Маска для телефона ===============
document.addEventListener("DOMContentLoaded", function () {
  var phoneInputs = document.querySelectorAll('input[type="tel"]');

  var getInputNumbersValue = function (input) {
    return input.value.replace(/\D/g, '');
  }

  var onPhonePaste = function (e) {
    var input = e.target,
      inputNumbersValue = getInputNumbersValue(input);
    var pasted = e.clipboardData || window.clipboardData;
    if (pasted) {
      var pastedText = pasted.getData('Text');
      if (/\D/g.test(pastedText)) {
        input.value = inputNumbersValue;
        return;
      }
    }
  }

  var onPhoneInput = function (e) {
    var input = e.target,
      inputNumbersValue = getInputNumbersValue(input),
      selectionStart = input.selectionStart,
      formattedInputValue = "";

    if (!inputNumbersValue) {
      return input.value = "";
    }

    if (input.value.length != selectionStart) {
      if (e.data && /\D/g.test(e.data)) {
        input.value = inputNumbersValue;
      }
      return;
    }

    if (["7", "8", "9"].indexOf(inputNumbersValue[0]) > -1) {
      if (inputNumbersValue[0] == "9") inputNumbersValue = "7" + inputNumbersValue;
      var firstSymbols = (inputNumbersValue[0] == "8") ? "8" : "+7";
      formattedInputValue = input.value = firstSymbols + " ";
      if (inputNumbersValue.length > 1) {
        formattedInputValue += '(' + inputNumbersValue.substring(1, 4);
      }
      if (inputNumbersValue.length >= 5) {
        formattedInputValue += ') ' + inputNumbersValue.substring(4, 7);
      }
      if (inputNumbersValue.length >= 8) {
        formattedInputValue += '-' + inputNumbersValue.substring(7, 9);
      }
      if (inputNumbersValue.length >= 10) {
        formattedInputValue += '-' + inputNumbersValue.substring(9, 11);
      }
    } else {
      formattedInputValue = '+' + inputNumbersValue.substring(0, 16);
    }
    input.value = formattedInputValue;
  }
  var onPhoneKeyDown = function (e) {
    var inputValue = e.target.value.replace(/\D/g, '');
    if (e.keyCode == 8 && inputValue.length == 1) {
      e.target.value = "";
    }
  }
  for (var phoneInput of phoneInputs) {
    phoneInput.addEventListener('keydown', onPhoneKeyDown);
    phoneInput.addEventListener('input', onPhoneInput, false);
    phoneInput.addEventListener('paste', onPhonePaste, false);
  }
})
